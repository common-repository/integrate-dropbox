(()=>{var e={694:(e,t,a)=>{"use strict";var i=a(925);function n(){}function r(){}r.resetWarningCache=n,e.exports=function(){function e(e,t,a,n,r,o){if(o!==i){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var a={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:r,resetWarningCache:n};return a.PropTypes=a,a}},556:(e,t,a)=>{e.exports=a(694)()},925:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}},t={};function a(i){var n=t[i];if(void 0!==n)return n.exports;var r=t[i]={exports:{}};return e[i](r,r.exports,a),r.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var i in t)a.o(t,i)&&!a.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";const e=window.React,t=window.wp.element,i=(e,t=null)=>(wp.ajax.settings.url||(wp.ajax.settings.url="/wp-admin/admin-ajax.php"),wp.ajax.post(e,{...t,nonce:indbox.nonce})),n=(0,t.createContext)(null),r=({handleRefresh:t})=>(0,e.createElement)("div",{onClick:t,className:"indbox-refresh"},(0,e.createElement)("span",{class:"dashicons dashicons-update"})," Refresh");var o=a(556),s=a.n(o);const d=({folder:a,refresh:o,setRefresh:s})=>{const{state:l,setActiveFolder:c,setFolders:p}=(0,t.useContext)(n),[m,h]=(0,t.useState)(!1),[u,f]=(0,t.useState)(!1),[b,x]=(0,t.useState)(!1),[g,w]=(0,t.useState)(!1),{activeFolder:y}=l;async function v(e=null,t=!1){x(!0);const n=e||a.file_id,r=await i("indbox_get_entries",{id:n,force:t});if(x(!1),r.data){f(r.data),p(r.data?.children);const e=r.data?.self;h(!0),w(!0),c({id:n,name:e.name,accountId:a.account_id})}}if((0,t.useEffect)((()=>{indbox.rootFolders?.length>0&&indbox.rootFolders[0].file_id===a.file_id&&(w((e=>!e)),h(!0),v())}),[]),"folder"===a.type)return(0,e.createElement)("div",{className:"indbox-media-folder"},(0,e.createElement)("div",{onClick:e=>{e.stopPropagation(),v()},onContextMenu:e=>{e.preventDefault(),s({id:a.file_id,name:a.name,accountId:a.account_id,clientX:e.clientX,clientY:e.clientY})},className:`indbox-folder-box${g?" indbox-folder-active":""}${a.file_id===y.id?" indbox-open-folder":""}`},(0,e.createElement)("span",{onClick:e=>{e.stopPropagation(),w((e=>!e)),v(),u||h(!0)},class:b?"indbox-spinner":"dashicons dashicons-arrow-right"}),(0,e.createElement)("span",{className:"indbox-folder-icon"}),(0,e.createElement)("span",{className:"indbox-folder-name"},a.name)),u&&m&&u.children?.map((t=>(0,e.createElement)(d,{key:t.id,folder:t,refresh:o,setRefresh:s}))),o&&o.id===a.file_id&&(0,e.createElement)(r,{handleRefresh:()=>{c({id:null,name:self.name,accountId:a.account_id}),v(o.id,!0),s(null)}}))},l=d;d.propTypes={folder:s().object};const c=()=>(0,e.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"lds-message",width:"80px",height:"80px",viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid"},(0,e.createElement)("script",{xmlns:""}),(0,e.createElement)("g",{transform:"translate(20 50)"},(0,e.createElement)("circle",{cx:"0",cy:"0",r:"7",fill:"#e15b64",transform:"scale(0.99275 0.99275)"},(0,e.createElement)("animateTransform",{attributeName:"transform",type:"scale",begin:"-0.375s",calcMode:"spline",keySplines:"0.3 0 0.7 1;0.3 0 0.7 1",values:"0;1;0",keyTimes:"0;0.5;1",dur:"1s",repeatCount:"indefinite"}))),(0,e.createElement)("g",{transform:"translate(40 50)"},(0,e.createElement)("circle",{cx:"0",cy:"0",r:"7",fill:"#f47e60",transform:"scale(0.773605 0.773605)"},(0,e.createElement)("animateTransform",{attributeName:"transform",type:"scale",begin:"-0.25s",calcMode:"spline",keySplines:"0.3 0 0.7 1;0.3 0 0.7 1",values:"0;1;0",keyTimes:"0;0.5;1",dur:"1s",repeatCount:"indefinite"}))),(0,e.createElement)("g",{transform:"translate(60 50)"},(0,e.createElement)("circle",{cx:"0",cy:"0",r:"7",fill:"#f8b26a",transform:"scale(0.42525 0.42525)"},(0,e.createElement)("animateTransform",{attributeName:"transform",type:"scale",begin:"-0.125s",calcMode:"spline",keySplines:"0.3 0 0.7 1;0.3 0 0.7 1",values:"0;1;0",keyTimes:"0;0.5;1",dur:"1s",repeatCount:"indefinite"}))),(0,e.createElement)("g",{transform:"translate(80 50)"},(0,e.createElement)("circle",{cx:"0",cy:"0",r:"7",fill:"#abbd81",transform:"scale(0.113418 0.113418)"},(0,e.createElement)("animateTransform",{attributeName:"transform",type:"scale",begin:"0s",calcMode:"spline",keySplines:"0.3 0 0.7 1;0.3 0 0.7 1",values:"0;1;0",keyTimes:"0;0.5;1",dur:"1s",repeatCount:"indefinite"}))),(0,e.createElement)("script",{xmlns:""})),p=()=>{const[a,r]=(0,t.useState)(null),{setFolders:o}=(0,t.useContext)(n),[s,d]=(0,t.useState)(!1);return(0,t.useEffect)((()=>{const e=async(e="/",t=!1)=>{const a=await i("indbox_get_entries",{id:e});a?.data&&(t?r({children:t}):(r(a.data),o(a.data?.children)))};if(indbox?.rootFolders?.length){const t=indbox.rootFolders.map((e=>({...e,type:"folder",id:e.file_id}))),a=t[0]?.file_id;e(a,t)}else e("/");return()=>r(null)}),[]),a?(0,e.createElement)("div",{className:"indbox-sidebar-body"},a.children?.map((t=>{var a;return(0,e.createElement)(l,{key:null!==(a=t.id)&&void 0!==a?a:t.file_id,folder:t,refresh:s,setRefresh:d})}))):(0,e.createElement)(c,null)},m=({id:a,title:i,classes:r,iconName:o,activeTab:s,setActiveTab:d,avatar:l=!1})=>{const{setActiveFolder:c}=(0,t.useContext)(n);return(0,e.createElement)("div",{onClick:()=>{d(a);const e=indbox.rootFolders?.length>0?indbox.rootFolders[0]:null;c(e&&"dropbox"===a?{name:e.name,id:e.file_id,accountId:e.account_id}:{name:i,id:"dropbox"===a?"dropbox":null,accountId:""})},className:`indbox-tab-item ${r}${a===s?" indbox-tab-active":""}`},(0,e.createElement)("i",{className:`indbox-tab-icon ${o}`}),(0,e.createElement)("span",{className:"indbox-tab-name"},i),l&&(0,e.createElement)("img",{className:"indbox-avatar",src:l,alt:"D",width:"35",height:"35"}))},h=m;m.propTypes={id:s().string,title:s().string,classes:s().string,iconName:s().string,activeTab:s().string,setActiveTab:s().func,avatar:s().string};const u={loading:!1,activeAccount:{},activeFolder:{name:"Media Library",id:null,accountId:null},folders:[]},f=(e,t)=>{switch(t.type){case"LOADING":return{...e,loading:t.payload};case"CHANGE_ACTIVE_ACCOUNT":return{...e,activeAccount:t.payload};case"CHANGE_ACTIVE_FOLDER":return{...e,activeFolder:t.payload};case"SET_FOLDERS":{const a=t.payload,i=e.folders,n=a?.filter((e=>!i.find((t=>t.id===e.file_id))&&"folder"===e.type)),r=n?.map((e=>({id:e.file_id,name:e.name,accountId:e.account_id})));return r&&r.length>0?{...e,folders:[...e.folders,...r]}:e}default:return e}},b=()=>{const[a,i]=(0,t.useState)("media"),{state:r}=(0,t.useContext)(n),{activeFolder:o,folders:s,activeAccount:d}=r;return(0,t.useEffect)((()=>{let e=o.id;indboxMedia.getFrame().find("#indbox-media-folder-filter").val(null!=e?e:"all").trigger("change")}),[o]),(0,t.useEffect)((()=>{var e;(e=s).length>0&&indboxMedia?.initFilter(e)}),[s]),(0,e.createElement)("div",{className:"indbox-media-library-sidebar"},(0,e.createElement)("div",{className:"indbox-sidebar-head indbox-tab"},(0,e.createElement)(h,{activeTab:a,setActiveTab:i,id:"media",title:"Media Library",classes:"indbox-media-library",iconName:"dashicons dashicons-admin-media"}),(0,e.createElement)(h,{activeTab:a,setActiveTab:i,id:"dropbox",title:"Dropbox",classes:"indbox-dropbox-media",iconName:"indbox-dropbox-icon",avatar:d?.image})),"dropbox"===a&&(0,e.createElement)(p,null))},x=({children:a})=>{const[r,o]=(0,t.useReducer)(f,u);(0,t.useState)((()=>{(async()=>{const e=await i("get_current_account");e?.email&&o({type:"CHANGE_ACTIVE_ACCOUNT",payload:e})})()}),[]);const s={state:r,dispatch:o,setLoading:e=>{o({type:"LOADING",payload:e})},setActiveAccount:e=>{o({type:"CHANGE_ACTIVE_ACCOUNT",payload:e})},setActiveFolder:e=>{o({type:"CHANGE_ACTIVE_FOLDER",payload:e})},setFolders:e=>{o({type:"SET_FOLDERS",payload:e})}};return(0,e.createElement)(n.Provider,{value:s},a)},g=new class{constructor(){this.$=jQuery}ready(){this.initModule()}initModule(){if("upload.php"===indbox.pagenow&&(this.$('#posts-filter input[name="mode"][value="list"]').length&&this.$("#posts-filter .media").length?this.pageType="upload-list":this.$("#wp-media-grid").length&&(this.pageType="upload-grid")),this.$('.upload-php #posts-filter input[name="mode"][value="list"]').length);else if("upload-list"!==this.pageType&&this.initFilter(),"undefined"!=typeof wp&&wp.media?.view?.AttachmentsBrowser){const e=this;wp.media.view.AttachmentsBrowser.prototype.on("ready",(function(){e.initTree(),"upload-list"!==e.pageType&&e.addAttachmentClass()}))}let e=wp?.media?.controller?.FeaturedImage;if(e){const t=this;wp.media.controller.FeaturedImage=e.extend({updateSelection:function(){e.prototype.updateSelection.apply(this,arguments),t.initTree()}})}let t=wp?.media?.view?.UploaderInline;if(t){const e=this;wp.media.view.UploaderInline=t.extend({ready:function(){t.prototype.ready.apply(this,arguments),e.initTree()}})}"upload-list"!==this.pageType&&(this.onModalOpen(),this.handleUploader(),this.handleUploadStatus())}getFrame(){if("upload-list"===this.pageType)return this.$(".upload-php #posts-filter");const e=this.$(".media-modal:visible");return e.length?e.find(".media-frame"):this.$(".upload-php .media-frame").first()}initTree(a=this.getFrame()){const i=this.$(a),n=this.$(".media-modal:visible").length>0,r="upload-list"===this.pageType||"upload-grid"===this.pageType,o=this.$(window).width();if(o<=900)return;let s;if(n||!r){if(i.hasClass("hide-menu")){const e=i.find(".media-search-input-label").text();i.find("#media-search-input").attr("placeholder",e),o>768&&i.addClass("indbox-tree-view").removeClass("hide-menu")}s=i.find(".media-frame-menu .indbox-media-tree-wrap").length>0}else s=this.$(".upload-php .indbox-media-tree-wrap").length>0;if(s){if(!r&&wp.media.frame&&"gallery-edit"===wp.media.frame._state){const e=this.getTreeElement(a);e.length&&(ReactDOM.unmountComponentAtNode(e[0]),e.remove())}else this.getTreeElement().show();return}if(n||!r){let e=i.find(".media-frame-menu .media-menu");e.length||(e=i.find(".media-frame-menu"),i.find(".media-frame-menu-heading").hide()),e.find(".indbox-media-tree-wrap").length||this.$('<div id="indbox-media-library-sidebar-wrapper" class="indbox-media-tree-wrap"></div>').appendTo(e)}else{const e=o<600?this.$("ul.attachments"):this.$("#wpbody-content");this.$(".upload-php .indbox-media-tree-wrap").length||this.$('<div id="indbox-media-library-sidebar-wrapper" class="indbox-media-tree-wrap"></div>').insertBefore(e)}const d=this.getTreeElement(a);d.length&&(0,t.createRoot)(d[0]).render((0,e.createElement)(x,null,(0,e.createElement)(b,null))),i.find(".indbox-media-toggle-actions").length||this.initActionsToggle(i)}getTreeElement(e=this.getFrame()){const t=this.$(".media-modal:visible").length>0,a="upload-grid"===this.pageType||"upload-list"===this.pageType;return t||!a?e.find(".indbox-media-tree-wrap").first():this.$(".upload-php .indbox-media-tree-wrap")}initActionsToggle(e=this.getFrame()){const t=e.find(".media-frame-menu-heading");t.append('<i class="indbox-media-toggle-actions dashicons dashicons-arrow-down"></i>'),t.on("click",(()=>{e.find(".media-menu").toggleClass("show-actions")}))}initFilter(e=[],t=!1){var a;const i=indbox?.activeAccount,n=(null!==(a=indbox.rootFolders)&&void 0!==a?a:[]).map((e=>({id:e.file_id,name:e.name,accountId:e.account_id})));if(void 0!==wp.media.view.AttachmentFilters){const a={dropbox:{text:wp.i18n.__("Dropbox"),props:{folder_id:"root",account_id:i.id}}};wp.media.view.AttachmentFilters.indbox_media_filter=wp.media.view.AttachmentFilters.extend({className:"indbox-media-folder-filter",id:"indbox-media-folder-filter",createFilters(){const i={all:{text:wp.i18n.__("Media Library"),props:{folder_id:null,account_id:null}},...a};[...e,...n].forEach((e=>{i[e.id]={text:e.name,props:{folder_id:e.id,account_id:e.accountId,is_refresh:t===e.id}}})),this.filters=i}})}const r=wp.media.view.AttachmentsBrowser;if(void 0!==r){const e=this;wp.media.view.AttachmentsBrowser=wp.media.view.AttachmentsBrowser.extend({createToolbar(){this.$el.data("backboneView",this),r.prototype.createToolbar.apply(this,arguments),e.attachmentsBrowser=this,this.toolbar.set("indbox-media-folder-filter",new wp.media.view.AttachmentFilters.indbox_media_filter({controller:this.controller,model:this.collection.props,priority:-75}).render())}}),this.attachmentsBrowser&&this.attachmentsBrowser.toolbar.set("indbox-media-folder-filter",new wp.media.view.AttachmentFilters.indbox_media_filter({controller:this.attachmentsBrowser.controller,model:this.attachmentsBrowser.collection.props,priority:-75}).render())}}addAttachmentClass(){}onModalOpen(){const e=wp?.media?.view?.Modal;if(void 0!==e){const t=this;wp.media.view.Modal=e.extend({open:function(){e.prototype.open.apply(this,arguments);const a=t.$(".attachment-details"),i=a.find('input[name^="attachments["]').attr("name"),n=i?i.match(/attachments\[(\d+)\]\[menu_order\]/):null,r=n?n[1]:null;if(r&&wp.media.attachment(r).get("indbox_media_replace_id")){const e=a.find(".thumbnail");if(e.addClass("indbox-media-replaced"),0===e.find(".indbox-media-replaced-label").length){const t=`<span class="indbox-media-replaced-label dashicons dashicons-update-alt" title="${wp.i18n.__("Replaced with Dropbox","integrate-dropbox")}"></span>`;e.append(t)}}}})}}handleUploader(){}handleUploadStatus(){}};window.indboxMedia=g,g.ready()})()})();